{% extends "base.html" %}
{% load static %}
{% block title %} Inicio {% endblock %}
{% block content %}
    <div class="search-container container">
        <div class="row w-100 align-items-center">
            <!-- Columna del botó "Back" -->

            <div class="col-6 col-md-3 d-flex justify-content-center justify-content-md-end mx-0 text-end  d-none d-md-block">
                <a href="{% url 'whoIsThatPokemon' %}" style="text-decoration: none; color: inherit; "  class="text-end">
                    <button class="back_button">
                        <svg height="16" width="16" xmlns="http://www.w3.org/2000/svg" version="1.1"
                             viewBox="0 0 1024 1024">
                            <path d="M874.690416 495.52477c0 11.2973-9.168824 20.466124-20.466124 20.466124l-604.773963 0 188.083679 188.083679c7.992021 7.992021 7.992021 20.947078 0 28.939099-4.001127 3.990894-9.240455 5.996574-14.46955 5.996574-5.239328 0-10.478655-1.995447-14.479783-5.996574l-223.00912-223.00912c-3.837398-3.837398-5.996574-9.046027-5.996574-14.46955 0-5.433756 2.159176-10.632151 5.996574-14.46955l223.019353-223.029586c7.992021-7.992021 20.957311-7.992021 28.949332 0 7.992021 8.002254 7.992021 20.957311 0 28.949332l-188.073446 188.073446 604.753497 0C865.521592 475.058646 874.690416 484.217237 874.690416 495.52477z"></path>
                        </svg>
                        <span>Back</span>
                    </button>
                </a>
            </div>

            <!-- Columna del buscador -->
            <div class="col-12 col-md-6 d-flex justify-content-center">
                <div class="InputContainer" style="width: 100%; max-width: 400px;">
                    <input type="text" name="text" class="input" id="input" placeholder="Search">
                    <label for="input" class="labelforsearch">
                        <svg viewBox="0 0 512 512" class="searchIcon">
                            <path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"></path>
                        </svg>
                    </label>
                    <div class="border"></div>
                    <button class="micButton">
                        <svg viewBox="0 0 384 512" class="micIcon">
                            <path d="M192 0C139 0 96 43 96 96V256c0 53 43 96 96 96s96-43 96-96V96c0-53-43-96-96-96zM64 216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 89.1 66.2 162.7 152 174.4V464H120c-13.3 0-24 10.7-24 24s10.7 24 24 24h72 72c13.3 0 24-10.7 24-24s-10.7-24-24-24H216V430.4c85.8-11.7 152-85.3 152-174.4V216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 70.7-57.3 128-128 128s-128-57.3-128-128V216z"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Columna del botó "Play Game" -->
            <div class="col-12 col-md-3 d-flex justify-content-center justify-content-md-end d-none d-md-block">
                <a href="{% url 'whoIsThatPokemon' %}" style="text-decoration: none; color: inherit">
                    <button class="play-game-button">
                        <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png"
                             alt="Pikachu" class="pokemon-icon">
                        <span>Play Game</span>
                    </button>
                </a>
            </div>
        </div>
    </div>
    <div class="row w-100 align-items-center d-block d-md-none mx-0">
        
        <div class="row">
            <div class="col-6 col-md-3 d-flex justify-content-center justify-content-md-end mx-0 text-end">
                <a href="{% url 'whoIsThatPokemon' %}" style="text-decoration: none; color: inherit; "  class="text-end">
                    <button class="back_button">
                        <svg height="16" width="16" xmlns="http://www.w3.org/2000/svg" version="1.1"
                             viewBox="0 0 1024 1024">
                            <path d="M874.690416 495.52477c0 11.2973-9.168824 20.466124-20.466124 20.466124l-604.773963 0 188.083679 188.083679c7.992021 7.992021 7.992021 20.947078 0 28.939099-4.001127 3.990894-9.240455 5.996574-14.46955 5.996574-5.239328 0-10.478655-1.995447-14.479783-5.996574l-223.00912-223.00912c-3.837398-3.837398-5.996574-9.046027-5.996574-14.46955 0-5.433756 2.159176-10.632151 5.996574-14.46955l223.019353-223.029586c7.992021-7.992021 20.957311-7.992021 28.949332 0 7.992021 8.002254 7.992021 20.957311 0 28.949332l-188.073446 188.073446 604.753497 0C865.521592 475.058646 874.690416 484.217237 874.690416 495.52477z"></path>
                        </svg>
                        <span>Back</span>
                    </button>
                </a>
            </div>
            <div class="col-6 col-md-3 d-flex justify-content-center justify-content-md-end mx-0">
                <a href="{% url 'whoIsThatPokemon' %}" style="text-decoration: none; color: inherit">
                    <button class="play-game-button">
                        <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png"
                             alt="Pikachu" class="pokemon-icon">
                        <span>Play Game</span>
                    </button>
                </a>
            </div>
        </div>
    </div>



    <div class="container">
        {% for pokemon in pokemons %}
            {% if pokemon.id in captured_pokemons %}
                {% if pokemon.id == 152 %}
                    <div class="carta {{ pokemon.types.0.type.name }} {{ pokemon.types.1.type.name }}"
                         data-pokemon-name="{{ pokemon.name }}">
                        <div class="carta-contenidor">
                            <img src={% static "img/hackduck.png" %} alt = "Imagen de {{ pokemon.name }}" class="
            carta-imatge-obtained">
                            <h2 class="carta-nom">{{ pokemon.name }}</h2>
                            <p class="carta-id">ID: {{ pokemon.id }}</p>
                            <ul class="carta-tipus">
                                {% for type in pokemon.types %}
                                    <li>{{ type.type.name }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                {% elif pokemon.id == 153 %}
                    <div class="carta {{ pokemon.types.0.type.name }} {{ pokemon.types.1.type.name }}"
                         data-pokemon-name="{{ pokemon.name }}">
                        <div class="carta-contenidor">
                            <img src={% static "img/cyberduck.png" %} alt = "Imagen de {{ pokemon.name }}" class="
            carta-imatge-obtained">
                            <h2 class="carta-nom">{{ pokemon.name }}</h2>
                            <p class="carta-id">ID: {{ pokemon.id }}</p>
                            <ul class="carta-tipus">
                                {% for type in pokemon.types %}
                                    <li>{{ type.type.name }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                {% else %}
                    <div class="carta {{ pokemon.types.0.type.name }} {{ pokemon.types.1.type.name }}"
                         data-pokemon-name="{{ pokemon.name }}">
                        <div class="carta-contenidor">
                            <img src="{{ pokemon.image }}" alt="Imagen de {{ pokemon.name }}"
                                 class="carta-imatge-obtained">
                            <h2 class="carta-nom">{{ pokemon.name }}</h2>
                            <p class="carta-id">ID: {{ pokemon.id }}</p>
                            <ul class="carta-tipus">
                                {% for type in pokemon.types %}
                                    <li>{{ type.type.name }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                {% endif %}
            {% else %}
                {% if pokemon.id == 152 %}
                    <div class="carta {{ pokemon.types.0.type.name }} {{ pokemon.types.1.type.name }}"
                         data-pokemon-name="{{ pokemon.name }}">
                        <div class="carta-contenidor">
                            <img src={% static "img/hackduck.png" %} alt = "Imagen de {{ pokemon.name }}" class="

            carta-imatge">
                            <h2 class="carta-nom">????</h2>
                            <p class="carta-id">ID: {{ pokemon.id }}</p>
                            <p class="carta-tipus">????</p>
                        </div>
                    </div>
                {% elif pokemon.id == 153 %}
                    <div class="carta {{ pokemon.types.0.type.name }} {{ pokemon.types.1.type.name }}"
                         data-pokemon-name="{{ pokemon.name }}">
                        <div class="carta-contenidor">
                            <img src={% static "img/cyberduck.png" %} alt="Imagen de {{ pokemon.name }}"
                            class="carta-imatge">
                            <h2 class="carta-nom">????</h2>
                            <p class="carta-id">ID: {{ pokemon.id }}</p>
                            <p class="carta-tipus">????</p>
                        </div>
                    </div>
                {% else %}
                    <div class="carta {{ pokemon.types.0.type.name }} {{ pokemon.types.1.type.name }}"
                         data-pokemon-name="{{ pokemon.name }}">
                        <div class="carta-contenidor">
                            <img src="{{ pokemon.image }}" alt="Imagen de {{ pokemon.name }}" class="carta-imatge">
                            <h2 class="carta-nom">????</h2>
                            <p class="carta-id">ID: {{ pokemon.id }}</p>
                            <p class="carta-tipus">????</p>
                        </div>
                    </div>
                {% endif %}
            {% endif %}
        {% endfor %}
    </div>

    <script>
        const searchInput = document.getElementById('input');
        const micButton = document.querySelector('.micButton');
        let recognition;

        if ('webkitSpeechRecognition' in window) {
            recognition = new webkitSpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onresult = (event) => {
                const spokenText = event.results[0][0].transcript.toLowerCase();
                searchInput.value = spokenText;
                searchInput.dispatchEvent(new Event('input'));
            };

            recognition.onerror = (event) => {
                console.error('Speech recognition error:', event.error);
            };

            micButton.addEventListener('click', () => {
                recognition.start();
                micButton.classList.add('listening');
            });

            recognition.onend = () => {
                micButton.classList.remove('listening');
            };
        } else {
            micButton.style.display = 'none';
        }

        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase().replace(/[^a-z0-9]/g, '');
            const cards = document.querySelectorAll('.carta');

            cards.forEach(card => {
                const pokemonName = card.dataset.pokemonName
                    .toLowerCase()
                    .replace(/[^a-z0-9]/g, '');

                if (pokemonName.includes(searchTerm)) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        });
    </script>
{% endblock %}